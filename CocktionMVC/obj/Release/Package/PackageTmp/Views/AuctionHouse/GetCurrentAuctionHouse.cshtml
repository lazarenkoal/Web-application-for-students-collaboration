@{
    ViewBag.Title = "Конкретный дом";
}
@using CocktionMVC.Models.DAL
@using Microsoft.AspNet.Identity
@model House
<h3>Домик в @Model.Holder.Name</h3>

<script src="~/Scripts/MyLib/AuctionHouse/GetCurrentAuctionHouse/addComment.js"></script>
<script src="~/Scripts/MyLib/AuctionHouse/GetCurrentAuctionHouse/scroller.js"></script>
<script src="~/Scripts/MyLib/AuctionHouse/GetCurrentAuctionHouse/subscriber.js"></script>

<link rel="stylesheet" href="~/Content/HouseRelatedStyles/getCurrentAuctionHouseStyle.css"/>

<div class="row" id ="top">
    <!--Контейнер для первой части страницы-->
    <div class="col-md-3">
        <!--Фотка и описание доам-->
        <!--Фотография-->
        <img src="http://cocktion.com/Images/Thumbnails/@Model.Portrait.FileName" class="img-thumbnail" />
        <br/>
        <br/>
    </div>
    <div class="col-md-7">
        <div class="row" id="imageLinksContainer">
            <!--Тут находятся ссылочки на странички с разными аукционами-->
            <div class="col-md-6">
                <!--Картинка с ссылкой на прошедшие аукционы-->
                <a href="http://cocktion.com/AuctionShower/ShowOldAuctions/@Model.Id">
                    <img src="~/Content/SiteImages/allProducts.jpg" class="img-thumbnail" />
                </a>
                <p>Прошедшие аукционы</p>
            </div>
            <div class="col-md-6">
                <!--Картинка с ссылкой на активные аукционы-->
                <a href="http://cocktion.com/AuctionShower/ShowActiveAuctions/@Model.Id">
                    <img src="~/Content/SiteImages/Roosters-Playing-Football-Funny-Animals.jpg" class="img-thumbnail" />
                </a>
                <p>Активные аукционы</p>
            </div>
        </div>
    </div>
    <div class="col-md-2" id="secondInfoColumn">
        <!--Лайки, рейтинг и кнопка-->
        <p><b>Лайки:</b> @Model.Likes</p>
        <br />
        <p><b>Дизлайки:</b> 0</p>
        <br />
        <p><b>Рейтинг:</b> @Model.Rating</p>
        <br />
        <p><b>Жители:</b> @Model.Inhabitants.Count</p>
        <br />
        <p><b>Количество аукционов:</b> @Model.Auctions.Count</p>
        <div id="subscribe">
            @{
                if (User.Identity.IsAuthenticated)
                {
                    <script>
                        checkSubscription(@Model.Id);
                    </script>
                }
                else
                {
                    <script>
                        document.getElementById('subscribe').innerHTML = "<p>Чтобы добавлять дома в свой колхоз, нужно быть авторизованным!</p>";
                    </script>
                }
            }
        </div>

    </div>
</div>
<div class="row">
    <div class="col-md-2"></div>
    <!--Контейнер для описания-->
    <div id="houseDescriptionContainer" class="col-md-8">
        <p>
            <b>Описание:</b> очень классный дом, ребята постоянно выкладывают интересные штуки,
            который удивляют своей уникальностью и необычностью.
        </p>
        <p><b>Адрес:</b> @Model.Adress
        </p>
        <script>houseId = @Model.Id</script>
        <p><b>Факультет:</b> @Model.Faculty</p>
    </div>
    <div class="col-md-2"></div>
</div>

<div class="row">
    <!--Здесь начинается форум-->
    <div class="col-md-3">
        <h3>Подписчики</h3>
        <div id="subscribersList">
            @foreach (var sub in Model.Inhabitants)
            {
                <p>@sub.UserName</p>
            }
        </div>
    </div>
    <div id="forumContainer" class="col-md-6">
        <h3 style="text-align: center">Дискуссия</h3>
        <div id="messageContainer">
            <!--Тут отображаются сообщения с форума-->
            @if (Model.Posts.Count > 0)
            {
                foreach (var post in Model.Posts)
                {
                    <div class="postContainer">
                        <div class="author">
                            <p>
                                <b>@post.AuthorName</b> сказал сегодня:
                            </p>
                        </div>
                        <div class="messageInstance">
                            <p>@post.Message</p>
                        </div>
                    </div>
                }
            }
            else
            {
                <p>Нет сообщений никаких!</p>
            }
        </div>
        <div id="messageEnterContainer">
            <div id="messageEnter">
                <p>
                    <b>Написать коммент</b>
                </p>
                <textarea rows="3" id="message"> </textarea>
                <button id="addCommentButton" onclick="addСomment(@Model.Id)" title=" аррррр!!!!" class="btn btn-default">Царапнуть</button>
            </div>
        </div>
    </div>
    <div class="col-md-3">
    </div>
</div>